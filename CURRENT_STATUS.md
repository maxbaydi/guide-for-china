# üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞ "–ì–∏–¥ –ø–æ –ö–∏—Ç–∞—é"

**–î–∞—Ç–∞**: 14 –æ–∫—Ç—è–±—Ä—è 2025, 00:40  
**–§–∞–∑–∞**: MVP Backend - –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞  
**–ü—Ä–æ–≥—Ä–µ—Å—Å**: ~40% –æ—Ç –ø–æ–ª–Ω–æ–≥–æ backend

---

## ‚úÖ –ß—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (100%)
- ‚úÖ **Docker Compose** —Å PostgreSQL 16, Redis 7, pgAdmin
- ‚úÖ **PostgreSQL —Å pg_jieba** —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞
- ‚úÖ **Redis** –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (–≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é)
- ‚úÖ **–ú–æ–Ω–æ—Ä–µ–ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** —Å workspace support

### 2. –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (100%)
- ‚úÖ **i18n** –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä—É—Å—Å–∫–æ–≥–æ –∏ –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ
- ‚úÖ **–†—É—Å—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã** –¥–ª—è common, errors, validation
- ‚úÖ **–ö–∏—Ç–∞–π—Å–∫–∏–µ –∑–∞–≥–ª—É—à–∫–∏** –≥–æ—Ç–æ–≤—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞
- ‚úÖ **TypeScript —Ç–∏–ø–∏–∑–∞—Ü–∏—è** –¥–ª—è –∫–ª—é—á–µ–π –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- ‚úÖ **–¢–µ—Å—Ç—ã** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –∫–ª—é—á–µ–π

### 3. Dictionary Service (100%) üéâ
#### –ü–∞—Ä—Å–∏–Ω–≥ –∏ –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **DSL Parser** –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∞ BKRS
- ‚úÖ **–ò–º–ø–æ—Ä—Ç 3.4M+ –∑–∞–ø–∏—Å–µ–π** –≤ PostgreSQL:
  - 349,812 –∏–µ—Ä–æ–≥–ª–∏—Ñ–æ–≤
  - 1,031,344 –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
  - 1,092,846 –ø—Ä–∏–º–µ—Ä–æ–≤
  - 923,318 —Ñ—Ä–∞–∑
- ‚úÖ **–°–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∞** BKRS —Ñ–∞–π–ª–æ–≤
- ‚úÖ **Database dump** –¥–ª—è production –≥–æ—Ç–æ–≤

#### GraphQL API
- ‚úÖ **5 –æ—Å–Ω–æ–≤–Ω—ã—Ö queries**:
  - `searchCharacters` - –ø–æ–∏—Å–∫ –∏–µ—Ä–æ–≥–ª–∏—Ñ–æ–≤
  - `getCharacter` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞ –ø–æ ID
  - `getCharacterBySimplified` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–º—É –Ω–∞–ø–∏—Å–∞–Ω–∏—é
  - `searchPhrases` - –ø–æ–∏—Å–∫ —Ñ—Ä–∞–∑
  - `analyzeText` - —Ä–∞–∑–±–æ—Ä –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –∏–µ—Ä–æ–≥–ª–∏—Ñ—ã

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ **58/58 —Ç–µ—Å—Ç–æ–≤** –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ:
  - i18n tests: 3/3
  - DSL Parser tests: 15/15
  - BKRS Analysis tests: 7/7
  - Import script tests: 6/6
  - pg_jieba tests: 9/9
  - Dictionary Service tests: 10/10
  - Dictionary Resolver tests: 8/8

### 4. API Gateway (80%)
- ‚úÖ **–ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** NestJS –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ **Redis integration** (RedisService –≥–æ—Ç–æ–≤)
- ‚úÖ **Rate limiting** (@nestjs/throttler)
- ‚úÖ **Health check** endpoint
- ‚úÖ **CORS** –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚ö†Ô∏è **Apollo Federation** - —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–º. –Ω–∏–∂–µ)

---

## ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

### Apollo Federation
**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- Dictionary Service —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ standalone GraphQL API
- API Gateway –ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Apollo Federation
- –î–ª—è Federation –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `@apollo/subgraph` –≤ Dictionary Service

**–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è MVP:**
1. **–í—Ä–µ–º–µ–Ω–Ω–æ** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dictionary Service –Ω–∞–ø—Ä—è–º—É—é (–ø–æ—Ä—Ç 3001)
2. **–ü–æ–∑–∂–µ** –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π Apollo Federation –∫–æ–≥–¥–∞ –ø–æ—è–≤—è—Ç—Å—è User –∏ Subscription —Å–µ—Ä–≤–∏—Å—ã

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:**
- –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ HTTP –ø—Ä–æ–∫—Å–∏-—Ä–µ–∑–æ–ª–≤–µ—Ä—ã –≤ API Gateway

---

## üìù –ß—Ç–æ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–æ—Å—Ç–∞–≤—à–∏–µ—Å—è 60%)

### User Service (0%)
- ‚ùå JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚ùå –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–≤—Ö–æ–¥
- ‚ùå Prisma —Å—Ö–µ–º–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚ùå Password hashing
- ‚ùå Refresh tokens

### Subscription Service (0%)
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Stripe/–ÆKassa
- ‚ùå Subscription tiers (FREE/BASIC/PREMIUM)
- ‚ùå Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
- ‚ùå Rate limiting –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º

### Production –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å (0%)
- ‚ùå Production docker-compose
- ‚ùå Nginx reverse proxy
- ‚ùå SSL/TLS –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚ùå GitHub Actions CI/CD
- ‚ùå –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üéØ –†–∞–±–æ—Ç–∞—é—â–∏–µ endpoints

### Dictionary Service
**URL:** http://localhost:3001/graphql  
**GraphQL Playground:** http://localhost:3001/graphql

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**

```graphql
# 1. –ü–æ–ª—É—á–∏—Ç—å –∏–µ—Ä–æ–≥–ª–∏—Ñ –ø–æ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–º—É –Ω–∞–ø–∏—Å–∞–Ω–∏—é
{
  getCharacterBySimplified(simplified: "‰Ω†") {
    simplified
    traditional
    pinyin
    definitions {
      translation
      partOfSpeech
    }
    examples {
      chinese
      russian
    }
  }
}

# 2. –†–∞–∑–æ–±—Ä–∞—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –∏–µ—Ä–æ–≥–ª–∏—Ñ—ã
{
  analyzeText(text: "ÊàëÂ≠¶‰π†‰∏≠Êñá") {
    character
    position
    details {
      simplified
      pinyin
      definitions {
        translation
      }
    }
  }
}

# 3. –ü–æ–∏—Å–∫ —Ñ—Ä–∞–∑
{
  searchPhrases(query: "–ø—Ä–∏–≤–µ—Ç", limit: 5) {
    russian
    chinese
    pinyin
  }
}
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)

### –°—Ä–æ—á–Ω–æ (–¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è MVP):
1. **–†–µ—à–∏—Ç—å –≤–æ–ø—Ä–æ—Å —Å API Gateway**
   - –õ–∏–±–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Federation
   - –õ–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dictionary Service –Ω–∞–ø—Ä—è–º—É—é
   
2. **–ù–∞—á–∞—Ç—å User Service**
   - JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–≤—Ö–æ–¥
   - –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã

### –°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫:
3. **Subscription Service**
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
   - Subscription tiers
   
4. **Rate limiting**
   - –ü–æ —Ç–∞—Ä–∏—Ñ–∞–º –ø–æ–¥–ø–∏—Å–∫–∏
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Redis

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ:
5. **Production deployment**
   - Docker compose production
   - Nginx + SSL
   - CI/CD

---

## üíæ –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏

```
guide-for-china/
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ dictionary/          ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—Ä—Ç 3001)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dist/           ‚úÖ –°–æ–±—Ä–∞–Ω
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma/         ‚úÖ –°—Ö–µ–º–∞ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ src/            ‚úÖ –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ + —Ç–µ—Å—Ç—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ api-gateway/         ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ (–ø–æ—Ä—Ç 3000)
‚îÇ       ‚îú‚îÄ‚îÄ dist/           ‚úÖ –°–æ–±—Ä–∞–Ω
‚îÇ       ‚îî‚îÄ‚îÄ src/            ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ
‚îú‚îÄ‚îÄ db_bkrs/                 ‚úÖ –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ BKRS
‚îú‚îÄ‚îÄ locales/                 ‚úÖ –ü–µ—Ä–µ–≤–æ–¥—ã (ru + zh –∑–∞–≥–ª—É—à–∫–∏)
‚îú‚îÄ‚îÄ infrastructure/          ‚úÖ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ docker-compose.yml       ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
‚îî‚îÄ‚îÄ .env                     ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ
```

---

## üîß –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

### –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker Compose
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose ps
```

### –ó–∞–ø—É—Å–∫ Dictionary Service
```bash
cd services/dictionary

# –°–æ–±—Ä–∞—Ç—å
npm run build

# –ó–∞–ø—É—Å—Ç–∏—Ç—å (–±—É–¥–µ—Ç –≤–∏—Å–µ—Ç—å, Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)
npm run start:dev

# –ò–ª–∏ –≤ —Ñ–æ–Ω–µ
npm run start:prod &
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# Dictionary Service —Ç–µ—Å—Ç—ã
cd services/dictionary
npm test

# –†–µ–∑—É–ª—å—Ç–∞—Ç: 58/58 ‚úÖ
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –∏–µ—Ä–æ–≥–ª–∏—Ñ–æ–≤ | 349,812 |
| –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π | 1,031,344 |
| –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–∏–º–µ—Ä–æ–≤ | 1,092,846 |
| –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ñ—Ä–∞–∑ | 923,318 |
| **–ò—Ç–æ–≥–æ –∑–∞–ø–∏—Å–µ–π –≤ –ë–î** | **~3.4M** |
| –¢–µ—Å—Ç–æ–≤ –Ω–∞–ø–∏—Å–∞–Ω–æ | 58 |
| –¢–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç | 58 ‚úÖ |
| –°–µ—Ä–≤–∏—Å–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç | 1/3 (Dictionary) |
| –ü—Ä–æ–≥—Ä–µ—Å—Å backend | ~40% |

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. **–ù–µ –∑–∞—Å—Ç—Ä–µ–≤–∞—Ç—å** –Ω–∞ Apollo Federation - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dictionary Service –Ω–∞–ø—Ä—è–º—É—é
2. **–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è** –Ω–∞ User Service - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. **–¢–µ—Å—Ç—ã** - –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø–∏—Å–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
4. **Database dump** –≥–æ—Ç–æ–≤ –¥–ª—è production –¥–µ–ø–ª–æ—è

### –î–ª—è production:
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å database dump –Ω–∞ VPS
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx –∫–∞–∫ reverse proxy
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —á–µ—Ä–µ–∑ Let's Encrypt
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ docker-compose.prod.yml

---

## üéâ –ì–ª–∞–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—é—â–∏–π Dictionary Service** —Å 3.4M –∑–∞–ø–∏—Å–µ–π  
‚úÖ **GraphQL API** –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
‚úÖ **pg_jieba** –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞  
‚úÖ **–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç** (58/58)  
‚úÖ **–ú–æ–Ω–æ—Ä–µ–ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** –≥–æ—Ç–æ–≤–∞ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è  
‚úÖ **Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ** –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ  

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è

1. **API Gateway**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dictionary Service –Ω–∞–ø—Ä—è–º—É—é –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Federation?
2. **–°–ª–µ–¥—É—é—â–∏–π —Å–µ—Ä–≤–∏—Å**: –ù–∞—á–∞—Ç—å —Å User Service –∏–ª–∏ —Å–Ω–∞—á–∞–ª–∞ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å Gateway?
3. **Production**: –ö–æ–≥–¥–∞ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ VPS?

