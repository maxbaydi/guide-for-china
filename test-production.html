<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞ - HanGuide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            color: #4fc3f7;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #b0b0b0;
            font-size: 1.1em;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .auth-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #f44336;
        }

        .status-indicator.authenticated {
            background: #4caf50;
        }

        .user-info {
            color: #4fc3f7;
            font-weight: bold;
        }

        .logout-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .logout-btn:hover {
            background: #d32f2f;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #e0e0e0;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .tab.active {
            background: #4fc3f7;
            color: #1a1a2e;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .section h2 {
            color: #4fc3f7;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #4fc3f7;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #b0b0b0;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: #e0e0e0;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4fc3f7;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            background: #4fc3f7;
            color: #1a1a2e;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            background: #29b6f6;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #666;
            color: #e0e0e0;
        }

        .btn-secondary:hover {
            background: #777;
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-danger:hover {
            background: #d32f2f;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #4fc3f7;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .result {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #4fc3f7;
        }

        .result h3 {
            color: #4fc3f7;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .copy-btn {
            background: #666;
            color: #e0e0e0;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .copy-btn:hover {
            background: #777;
        }

        .result pre {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .error {
            border-left-color: #f44336;
        }

        .error h3 {
            color: #f44336;
        }

        .success {
            border-left-color: #4caf50;
        }

        .success h3 {
            color: #4caf50;
        }

        .audio-player {
            margin-top: 15px;
        }

        .audio-player audio {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .character-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .character-card h4 {
            color: #4fc3f7;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .character-card .character {
            font-size: 2em;
            text-align: center;
            margin: 10px 0;
            color: #fff;
        }

        .character-card .pinyin {
            color: #ff9800;
            font-style: italic;
            margin-bottom: 5px;
        }

        .character-card .meaning {
            color: #b0b0b0;
            font-size: 0.9em;
        }

        .hidden {
            display: none !important;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            background: #f44336;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                text-align: center;
            }

            .grid {
                grid-template-columns: 1fr;
            }

            .status-bar {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞</h1>
            <p>HanGuide API Testing Dashboard</p>
            <div style="margin-top: 15px; padding: 10px; background: rgba(255, 193, 7, 0.1); border-radius: 8px; border-left: 4px solid #ffc107;">
                <strong>‚ö†Ô∏è –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç CORS –æ—à–∏–±–∫–∏:</strong><br>
                1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ <code>https://mypns.com</code><br>
                2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è <code>CORS_ORIGIN</code> –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ<br>
                3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ HTTP —Å–µ—Ä–≤–µ—Ä (–Ω–µ file://)
            </div>
        </div>

        <div class="status-bar">
            <div class="auth-status">
                <div class="status-indicator" id="authIndicator"></div>
                <span id="authStatus">–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω</span>
            </div>
            <div class="user-info" id="userInfo"></div>
            <button class="btn btn-secondary" id="checkServerBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä–≤–µ—Ä</button>
            <button class="logout-btn hidden" id="logoutBtn">–í—ã–π—Ç–∏</button>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="auth">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</button>
            <button class="tab" data-tab="rest">REST API</button>
            <button class="tab" data-tab="graphql">GraphQL</button>
            <button class="tab" data-tab="tts">TTS</button>
        </div>

        <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è -->
        <div class="tab-content active" id="auth">
            <div class="section">
                <h2>üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
                
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="authEmail" placeholder="test@example.com">
                </div>
                
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="authPassword" placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤">
                </div>
                
                <div class="form-group">
                    <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏):</label>
                    <input type="text" id="authUsername" placeholder="username">
                </div>
                
                <div class="form-group">
                    <label>–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è (–¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏):</label>
                    <input type="text" id="authDisplayName" placeholder="–ò–º—è –§–∞–º–∏–ª–∏—è">
                </div>
                
                <button class="btn" id="loginBtn">–í–æ–π—Ç–∏</button>
                <button class="btn btn-secondary" id="registerBtn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                <button class="btn btn-secondary" id="refreshBtn">–û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω</button>
                <button class="btn btn-secondary" id="meBtn">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</button>
            </div>
        </div>

        <!-- REST API -->
        <div class="tab-content" id="rest">
            <div class="section">
                <h2>üìö –°–ª–æ–≤–∞—Ä—å</h2>
                
                <div class="form-group">
                    <label>–ü–æ–∏—Å–∫ –∏–µ—Ä–æ–≥–ª–∏—Ñ–æ–≤:</label>
                    <input type="text" id="searchQuery" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–µ—Ä–æ–≥–ª–∏—Ñ, –ø–∏–Ω—å–∏–Ω—å –∏–ª–∏ –ø–µ—Ä–µ–≤–æ–¥">
                </div>
                <button class="btn" id="searchBtn">–ü–æ–∏—Å–∫</button>
                
                <div class="form-group">
                    <label>ID –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π:</label>
                    <input type="text" id="characterId" placeholder="ID –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞">
                </div>
                <button class="btn" id="characterBtn">–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏</button>
                <button class="btn btn-secondary" id="similarBtn">–ü–æ—Ö–æ–∂–∏–µ —Å–ª–æ–≤–∞</button>
                <button class="btn btn-secondary" id="reverseBtn">–û–±—Ä–∞—Ç–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥</button>
                
                <div class="form-group">
                    <label>–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞:</label>
                    <textarea id="analyzeText" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–∏—Ç–∞–π—Å–∫–∏–π —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"></textarea>
                </div>
                <button class="btn" id="analyzeBtn">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
                
                <button class="btn btn-secondary" id="wordOfDayBtn">–°–ª–æ–≤–æ –¥–Ω—è</button>
            </div>
        </div>

        <!-- GraphQL -->
        <div class="tab-content" id="graphql">
            <div class="section">
                <h2>üìÅ –ö–æ–ª–ª–µ–∫—Ü–∏–∏</h2>
                
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏:</label>
                    <input type="text" id="collectionName" placeholder="–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è">
                </div>
                
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏:</label>
                    <textarea id="collectionDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏"></textarea>
                </div>
                
                <button class="btn" id="createCollectionBtn">–°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é</button>
                <button class="btn btn-secondary" id="getCollectionsBtn">–ú–æ–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏</button>
                
                <div class="form-group">
                    <label>ID –∫–æ–ª–ª–µ–∫—Ü–∏–∏:</label>
                    <input type="text" id="collectionId" placeholder="ID –∫–æ–ª–ª–µ–∫—Ü–∏–∏">
                </div>
                
                <div class="form-group">
                    <label>ID –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:</label>
                    <input type="text" id="addCharacterId" placeholder="ID –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞">
                </div>
                
                <div class="form-group">
                    <label>–ó–∞–º–µ—Ç–∫–∏ –∫ –∏–µ—Ä–æ–≥–ª–∏—Ñ—É:</label>
                    <textarea id="characterNotes" placeholder="–ó–∞–º–µ—Ç–∫–∏"></textarea>
                </div>
                
                <button class="btn" id="addToCollectionBtn">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é</button>
                <button class="btn btn-secondary" id="removeFromCollectionBtn">–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏</button>
            </div>
        </div>

        <!-- TTS -->
        <div class="tab-content" id="tts">
            <div class="section">
                <h2>üîä –°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏</h2>
                
                <div class="form-group">
                    <label>–¢–µ–∫—Å—Ç –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞:</label>
                    <textarea id="ttsText" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–∏—Ç–∞–π—Å–∫–∏–π —Ç–µ–∫—Å—Ç –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏"></textarea>
                </div>
                
                <button class="btn" id="synthesizeBtn">–°–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>

        <div id="results"></div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API
        const API_CONFIG = {
            REST_BASE_URL: 'https://mypns.com/api/v1',
            GRAPHQL_URL: 'https://mypns.com/graphql',
            API_HOST: 'https://mypns.com',
            REST_HOST_PORT: 443,
            GRAPHQL_HOST_PORT: 443
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let authState = {
            isAuthenticated: false,
            accessToken: null,
            refreshToken: null,
            user: null
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            loadAuthState();
        });

        function initializeApp() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            const savedAuth = localStorage.getItem('authState');
            if (savedAuth) {
                try {
                    authState = JSON.parse(savedAuth);
                    updateAuthUI();
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', e);
                }
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            setTimeout(() => {
                checkServerHealth();
            }, 1000);
        }

        function setupEventListeners() {
            // –¢–∞–±—ã
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchTab(this.dataset.tab);
                });
            });

            // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
            document.getElementById('loginBtn').addEventListener('click', login);
            document.getElementById('registerBtn').addEventListener('click', register);
            document.getElementById('refreshBtn').addEventListener('click', refreshToken);
            document.getElementById('meBtn').addEventListener('click', getMe);
            document.getElementById('logoutBtn').addEventListener('click', logout);
            document.getElementById('checkServerBtn').addEventListener('click', checkServerHealth);

            // REST API
            document.getElementById('searchBtn').addEventListener('click', searchCharacters);
            document.getElementById('characterBtn').addEventListener('click', getCharacter);
            document.getElementById('similarBtn').addEventListener('click', getSimilarWords);
            document.getElementById('reverseBtn').addEventListener('click', getReverseTranslations);
            document.getElementById('analyzeBtn').addEventListener('click', analyzeText);
            document.getElementById('wordOfDayBtn').addEventListener('click', getWordOfDay);

            // GraphQL
            document.getElementById('createCollectionBtn').addEventListener('click', createCollection);
            document.getElementById('getCollectionsBtn').addEventListener('click', getCollections);
            document.getElementById('addToCollectionBtn').addEventListener('click', addToCollection);
            document.getElementById('removeFromCollectionBtn').addEventListener('click', removeFromCollection);

            // TTS
            document.getElementById('synthesizeBtn').addEventListener('click', synthesizeSpeech);
        }

        function switchTab(tabName) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —Ç–∞–±–æ–≤ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ç–∞–±—É –∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        function updateAuthUI() {
            const indicator = document.getElementById('authIndicator');
            const status = document.getElementById('authStatus');
            const userInfo = document.getElementById('userInfo');
            const logoutBtn = document.getElementById('logoutBtn');

            if (authState.isAuthenticated) {
                indicator.classList.add('authenticated');
                status.textContent = '–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
                userInfo.textContent = authState.user ? `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${authState.user.email}` : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω';
                logoutBtn.classList.remove('hidden');
            } else {
                indicator.classList.remove('authenticated');
                status.textContent = '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
                userInfo.textContent = '';
                logoutBtn.classList.add('hidden');
            }
        }

        function saveAuthState() {
            localStorage.setItem('authState', JSON.stringify(authState));
        }

        function loadAuthState() {
            const saved = localStorage.getItem('authState');
            if (saved) {
                try {
                    authState = JSON.parse(saved);
                    updateAuthUI();
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è:', e);
                }
            }
        }

        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${isError ? 'error' : ''}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function showLoading(button) {
            const originalText = button.textContent;
            button.disabled = true;
            button.innerHTML = '<span class="loading"></span> –ó–∞–≥—Ä—É–∑–∫–∞...';
            return () => {
                button.disabled = false;
                button.textContent = originalText;
            };
        }

        function showResult(title, data, isError = false) {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${isError ? 'error' : 'success'}`;
            
            const jsonString = JSON.stringify(data, null, 2);
            
            resultDiv.innerHTML = `
                <h3>
                    ${title}
                    <button class="copy-btn" onclick="copyToClipboard('${jsonString.replace(/'/g, "\\'")}')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </h3>
                <pre>${jsonString}</pre>
            `;
            
            resultsDiv.appendChild(resultDiv);
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            }).catch(() => {
                showToast('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', true);
            });
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
        async function checkServerHealth() {
            try {
                const response = await fetch(`${API_CONFIG.REST_BASE_URL.replace('/api/v1', '')}/health`);
                if (response.ok) {
                    showToast('‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω!');
                    return true;
                } else {
                    showToast('‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', true);
                    return false;
                }
            } catch (error) {
                showToast('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É: ' + error.message, true);
                return false;
            }
        }

        // API —Ñ—É–Ω–∫—Ü–∏–∏
        async function makeRequest(url, options = {}) {
            const defaultOptions = {
                headers: {
                    'Content-Type': 'application/json',
                }
            };

            if (authState.accessToken) {
                defaultOptions.headers.Authorization = `Bearer ${authState.accessToken}`;
            }

            const finalOptions = {
                ...defaultOptions,
                ...options,
                headers: {
                    ...defaultOptions.headers,
                    ...options.headers
                }
            };

            try {
                const response = await fetch(url, finalOptions);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º CORS –æ—à–∏–±–∫–∏
                if (response.status === 0 || !response.ok) {
                    const errorText = await response.text();
                    console.error('Response error:', response.status, errorText);
                    
                    if (response.status === 0) {
                        throw new Error('CORS –æ—à–∏–±–∫–∞: —Å–µ—Ä–≤–µ—Ä –Ω–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å —ç—Ç–æ–≥–æ –¥–æ–º–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.');
                    }
                    
                    try {
                        const data = JSON.parse(errorText);
                        throw new Error(data.message || `HTTP ${response.status}`);
                    } catch (parseError) {
                        throw new Error(`HTTP ${response.status}: ${errorText}`);
                    }
                }

                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Request error:', error);
                
                // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ CORS –æ—à–∏–±–æ–∫
                if (error.message.includes('CORS') || error.message.includes('blocked by CORS')) {
                    throw new Error('CORS –æ—à–∏–±–∫–∞: —Å–µ—Ä–≤–µ—Ä –Ω–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å —ç—Ç–æ–≥–æ –¥–æ–º–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.');
                }
                
                if (error.message.includes('Failed to fetch')) {
                    throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞.');
                }
                
                throw error;
            }
        }

        async function makeGraphQLRequest(query, variables = {}) {
            return makeRequest(API_CONFIG.GRAPHQL_URL, {
                method: 'POST',
                body: JSON.stringify({ query, variables })
            });
        }

        // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
        async function login() {
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;

            if (!email || !password) {
                showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('loginBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/auth/login`, {
                    method: 'POST',
                    body: JSON.stringify({ email, password })
                });

                authState.isAuthenticated = true;
                authState.accessToken = data.accessToken;
                authState.refreshToken = data.refreshToken;
                authState.user = data.user;

                saveAuthState();
                updateAuthUI();
                showResult('–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥', data);
                showToast('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function register() {
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;
            const username = document.getElementById('authUsername').value;
            const displayName = document.getElementById('authDisplayName').value;

            if (!email || !password) {
                showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('registerBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/auth/register`, {
                    method: 'POST',
                    body: JSON.stringify({ email, password, username, displayName })
                });

                authState.isAuthenticated = true;
                authState.accessToken = data.accessToken;
                authState.refreshToken = data.refreshToken;
                authState.user = data.user;

                saveAuthState();
                updateAuthUI();
                showResult('–£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', data);
                showToast('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function refreshToken() {
            if (!authState.refreshToken) {
                showToast('–ù–µ—Ç refresh token', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('refreshBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/auth/refresh`, {
                    method: 'POST',
                    body: JSON.stringify({ refreshToken: authState.refreshToken })
                });

                authState.accessToken = data.accessToken;
                authState.refreshToken = data.refreshToken;

                saveAuthState();
                showResult('–¢–æ–∫–µ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω', data);
                showToast('–¢–æ–∫–µ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function getMe() {
            const hideLoading = showLoading(document.getElementById('meBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/auth/me`);
                authState.user = data.user;
                saveAuthState();
                showResult('–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', data);
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        function logout() {
            authState.isAuthenticated = false;
            authState.accessToken = null;
            authState.refreshToken = null;
            authState.user = null;

            saveAuthState();
            updateAuthUI();
            showToast('–í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω');
        }

        // REST API —Ñ—É–Ω–∫—Ü–∏–∏
        async function searchCharacters() {
            const query = document.getElementById('searchQuery').value;
            if (!query) {
                showToast('–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('searchBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/dictionary/search?query=${encodeURIComponent(query)}&limit=20`);
                showResult('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞', data);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –≤–∏–¥–µ –∫–∞—Ä—Ç–æ—á–µ–∫
                if (data.length > 0) {
                    displayCharacterCards(data);
                }
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        function displayCharacterCards(characters) {
            const resultsDiv = document.getElementById('results');
            const cardsDiv = document.createElement('div');
            cardsDiv.className = 'grid';
            
            characters.forEach(char => {
                const card = document.createElement('div');
                card.className = 'character-card';
                card.innerHTML = `
                    <h4>${char.simplified || char.traditional || 'N/A'}</h4>
                    <div class="character">${char.simplified || char.traditional || 'N/A'}</div>
                    <div class="pinyin">${char.pinyin || 'N/A'}</div>
                    <div class="meaning">${char.meaning || 'N/A'}</div>
                `;
                cardsDiv.appendChild(card);
            });
            
            resultsDiv.appendChild(cardsDiv);
        }

        async function getCharacter() {
            const id = document.getElementById('characterId').value;
            if (!id) {
                showToast('–í–≤–µ–¥–∏—Ç–µ ID –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('characterBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/dictionary/character/${id}`);
                showResult('–î–µ—Ç–∞–ª–∏ –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞', data);
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function getSimilarWords() {
            const id = document.getElementById('characterId').value;
            if (!id) {
                showToast('–í–≤–µ–¥–∏—Ç–µ ID –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('similarBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/dictionary/character/${id}/similar?limit=20`);
                showResult('–ü–æ—Ö–æ–∂–∏–µ —Å–ª–æ–≤–∞', data);
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Ö–æ–∂–∏—Ö —Å–ª–æ–≤', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Ö–æ–∂–∏—Ö —Å–ª–æ–≤: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function getReverseTranslations() {
            const id = document.getElementById('characterId').value;
            if (!id) {
                showToast('–í–≤–µ–¥–∏—Ç–µ ID –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('reverseBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/dictionary/character/${id}/reverse?limit=20`);
                showResult('–û–±—Ä–∞—Ç–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥', data);
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function analyzeText() {
            const text = document.getElementById('analyzeText').value;
            if (!text) {
                showToast('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('analyzeBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/dictionary/analyze?text=${encodeURIComponent(text)}`);
                showResult('–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞', data);
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function getWordOfDay() {
            const hideLoading = showLoading(document.getElementById('wordOfDayBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/dictionary/word-of-the-day`);
                showResult('–°–ª–æ–≤–æ –¥–Ω—è', data);
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª–æ–≤–∞ –¥–Ω—è', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª–æ–≤–∞ –¥–Ω—è: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        // GraphQL —Ñ—É–Ω–∫—Ü–∏–∏
        async function createCollection() {
            const name = document.getElementById('collectionName').value;
            const description = document.getElementById('collectionDescription').value;

            if (!name) {
                showToast('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('createCollectionBtn'));

            try {
                const query = `
                    mutation CreateCollection($input: CreateCollectionInput!) {
                        createCollection(input: $input) {
                            id
                            name
                            description
                            createdAt
                            updatedAt
                        }
                    }
                `;

                const data = await makeGraphQLRequest(query, {
                    input: { name, description }
                });

                showResult('–ö–æ–ª–ª–µ–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞', data);
                showToast('–ö–æ–ª–ª–µ–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function getCollections() {
            const hideLoading = showLoading(document.getElementById('getCollectionsBtn'));

            try {
                const query = `
                    query MyCollections {
                        myCollections {
                            id
                            name
                            description
                            createdAt
                            updatedAt
                            items {
                                id
                                characterId
                                notes
                                addedAt
                            }
                        }
                    }
                `;

                const data = await makeGraphQLRequest(query);
                showResult('–ú–æ–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏', data);
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–π', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–π: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function addToCollection() {
            const collectionId = document.getElementById('collectionId').value;
            const characterId = document.getElementById('addCharacterId').value;
            const notes = document.getElementById('characterNotes').value;

            if (!collectionId || !characterId) {
                showToast('–í–≤–µ–¥–∏—Ç–µ ID –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ ID –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('addToCollectionBtn'));

            try {
                const query = `
                    mutation AddToCollection($collectionId: String!, $input: AddToCollectionInput!) {
                        addToCollection(collectionId: $collectionId, input: $input) {
                            id
                            characterId
                            notes
                            addedAt
                        }
                    }
                `;

                const data = await makeGraphQLRequest(query, {
                    collectionId,
                    input: { characterId, notes }
                });

                showResult('–ò–µ—Ä–æ–≥–ª–∏—Ñ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é', data);
                showToast('–ò–µ—Ä–æ–≥–ª–∏—Ñ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é!');
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        async function removeFromCollection() {
            const collectionId = document.getElementById('collectionId').value;
            const characterId = document.getElementById('addCharacterId').value;

            if (!collectionId || !characterId) {
                showToast('–í–≤–µ–¥–∏—Ç–µ ID –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ ID –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('removeFromCollectionBtn'));

            try {
                const query = `
                    mutation RemoveFromCollection($collectionId: String!, $characterId: String!) {
                        removeFromCollection(collectionId: $collectionId, characterId: $characterId)
                    }
                `;

                const data = await makeGraphQLRequest(query, {
                    collectionId,
                    characterId
                });

                showResult('–ò–µ—Ä–æ–≥–ª–∏—Ñ —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏', data);
                showToast('–ò–µ—Ä–æ–≥–ª–∏—Ñ —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏!');
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }

        // TTS —Ñ—É–Ω–∫—Ü–∏–∏
        async function synthesizeSpeech() {
            const text = document.getElementById('ttsText').value;
            if (!text) {
                showToast('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞', true);
                return;
            }

            const hideLoading = showLoading(document.getElementById('synthesizeBtn'));

            try {
                const data = await makeRequest(`${API_CONFIG.REST_BASE_URL}/tts/synthesize`, {
                    method: 'POST',
                    body: JSON.stringify({ text })
                });

                showResult('–°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏', data);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∞—É–¥–∏–æ–ø–ª–µ–µ—Ä
                if (data.audioUrl) {
                    const audioDiv = document.createElement('div');
                    audioDiv.className = 'audio-player';
                    audioDiv.innerHTML = `
                        <audio controls>
                            <source src="${data.audioUrl}" type="audio/wav">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç.
                        </audio>
                    `;
                    
                    const lastResult = document.querySelector('#results .result:last-child');
                    if (lastResult) {
                        lastResult.appendChild(audioDiv);
                    }
                }
                
                showToast('–°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω!');
            } catch (error) {
                showResult('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏', { error: error.message }, true);
                showToast('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏: ' + error.message, true);
            } finally {
                hideLoading();
            }
        }
    </script>
</body>
</html>
