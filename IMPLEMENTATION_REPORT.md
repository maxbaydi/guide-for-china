# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ò–Ω–¥–µ–∫—Å—ã –ë–î –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–î–∞—Ç–∞**: 15 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## üéØ –¶–µ–ª–∏ –∑–∞–¥–∞—á–∏

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –ë–î –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞
2. –í–Ω–µ–¥—Ä–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ Redis
3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–æ–≤–∞ –¥–Ω—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–æ–∏—Å–∫–∞

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞ –¥–Ω—è

**–§–∞–π–ª**: `services/dictionary/src/services/dictionary.service.ts`

**–ü—Ä–æ–±–ª–µ–º—ã –Ω–∞–π–¥–µ–Ω—ã**:
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã: `chinese_characters` ‚Üí `characters`
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –∫–æ–ª–æ–Ω–∫–∏: `hsk_level` ‚Üí `"hskLevel"`
- ‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö —Å HSK —É—Ä–æ–≤–Ω—è–º–∏ –≤ –ë–î (BKRS –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é)

**–†–µ—à–µ–Ω–∏—è**:
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—ã –∏ –∫–æ–ª–æ–Ω–∫–∏
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞: –≤—ã–±–æ—Ä –∏–µ—Ä–æ–≥–ª–∏—Ñ–æ–≤ –¥–ª–∏–Ω–æ–π 1 —Å–∏–º–≤–æ–ª —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç—ã (md5 hash)
- ‚úÖ Fallback –Ω–∞ –ª—é–±–æ–π –∏–µ—Ä–æ–≥–ª–∏—Ñ —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º, –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å –Ω–µ –¥–∞–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### 2. –ò–Ω–¥–µ–∫—Å—ã –ë–î

#### 2.1 Dictionary –ë–î

**–§–∞–π–ª**: `infrastructure/postgres/migrations/004_add_performance_indexes.sql`

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã**:

**–¢–∞–±–ª–∏—Ü–∞ `characters`** (6 –∏–Ω–¥–µ–∫—Å–æ–≤):
```sql
idx_characters_search_vector         -- GIN –¥–ª—è –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞
idx_characters_hsk_level             -- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ HSK
idx_characters_frequency             -- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç–∏
idx_characters_hsk_frequency         -- –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π (HSK + frequency)
idx_characters_simplified_pattern    -- LIKE/ILIKE –ø–æ–∏—Å–∫ (text_pattern_ops)
idx_characters_pinyin_pattern        -- LIKE/ILIKE –ø–æ –ø–∏–Ω—å–∏–Ω—é
```

**–¢–∞–±–ª–∏—Ü–∞ `definitions`** (3 –∏–Ω–¥–µ–∫—Å–∞):
```sql
idx_definitions_translation_gin      -- GIN –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ (—Ä—É—Å—Å–∫–∏–π)
idx_definitions_translation_pattern  -- LIKE/ILIKE –ø–æ –ø–µ—Ä–µ–≤–æ–¥–∞–º
idx_definitions_character_order      -- –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
```

**–¢–∞–±–ª–∏—Ü–∞ `examples`** (1 –∏–Ω–¥–µ–∫—Å):
```sql
idx_examples_character_created       -- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–º–µ—Ä–æ–≤ –ø–æ –¥–∞—Ç–µ
```

**–¢–∞–±–ª–∏—Ü–∞ `phrases`** (5 –∏–Ω–¥–µ–∫—Å–æ–≤):
```sql
idx_phrases_search_vector            -- GIN –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫
idx_phrases_russian_gin              -- GIN –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
idx_phrases_russian_pattern          -- LIKE/ILIKE –ø–æ —Ä—É—Å—Å–∫–æ–º—É
idx_phrases_chinese_pattern          -- LIKE/ILIKE –ø–æ –∫–∏—Ç–∞–π—Å–∫–æ–º—É
idx_phrases_created                  -- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ
```

**–ò—Ç–æ–≥–æ**: 15 –Ω–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**:
```bash
docker exec -i guide-postgres psql -U postgres -d chinese_guide < infrastructure/postgres/migrations/004_add_performance_indexes.sql
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏)

#### 2.2 User –ë–î

**–§–∞–π–ª**: `infrastructure/postgres/migrations/005_add_user_indexes.sql`

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã**:

**–¢–∞–±–ª–∏—Ü–∞ `users`** (3 –∏–Ω–¥–µ–∫—Å–∞):
```sql
idx_users_last_active                -- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
idx_users_created                    -- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π
idx_users_subscription_active        -- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ + —Å—Ç–∞—Ç—É—Å
```

**–¢–∞–±–ª–∏—Ü–∞ `collections`** (2 –∏–Ω–¥–µ–∫—Å–∞):
```sql
idx_collections_user_created         -- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
idx_collections_public               -- Partial index –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
```

**–¢–∞–±–ª–∏—Ü–∞ `collection_items`** (1 –∏–Ω–¥–µ–∫—Å):
```sql
idx_collection_items_added           -- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ –¥–∞—Ç–µ
```

**–ò—Ç–æ–≥–æ**: 6 –Ω–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**:
```bash
docker exec -i guide-postgres psql -U postgres -d chinese_guide < infrastructure/postgres/migrations/005_add_user_indexes.sql
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ

**Prisma Schema**:
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `services/user/prisma/schema.prisma` —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- ‚úÖ –ü—Ä–∏ –Ω–æ–≤–æ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ Prisma —Å–æ–∑–¥–∞—Å—Ç –∏–Ω–¥–µ–∫—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ SQL –º–∏–≥—Ä–∞—Ü–∏–∏, –Ω–µ Prisma migrate)

### 3. Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 3.1 –°–æ–∑–¥–∞–Ω–∏–µ Redis Service

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- `services/dictionary/src/redis/redis.module.ts` - –º–æ–¥—É–ª—å Redis
- `services/dictionary/src/redis/redis.service.ts` - —Å–µ—Ä–≤–∏—Å —Å –º–µ—Ç–æ–¥–∞–º–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–ë–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```typescript
get(key: string): Promise<string | null>
set(key: string, value: string, ttl?: number): Promise<void>
del(key: string): Promise<void>
```

**–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è**:
```typescript
cacheSearchResults(query, results, ttl=300)         // 5 –º–∏–Ω—É—Ç
getCachedSearchResults(query)

cacheCharacter(id, character, ttl=3600)             // 1 —á–∞—Å
getCachedCharacter(id)

cacheWordOfTheDay(character, ttl=86400)             // 24 —á–∞—Å–∞
getCachedWordOfTheDay()

cacheAnalysisResults(text, results, ttl=1800)       // 30 –º–∏–Ω—É—Ç
getCachedAnalysisResults(text)

cachePhraseSearchResults(query, results, ttl=300)   // 5 –º–∏–Ω—É—Ç
getCachedPhraseSearchResults(query)

invalidateCache(pattern)                            // –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É
```

#### 3.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Dictionary Service

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**:
- `services/dictionary/src/app.module.ts` - –¥–æ–±–∞–≤–ª–µ–Ω ConfigModule
- `services/dictionary/src/dictionary.module.ts` - –¥–æ–±–∞–≤–ª–µ–Ω RedisModule
- `services/dictionary/src/services/dictionary.service.ts` - –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ú–µ—Ç–æ–¥—ã —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º**:
| –ú–µ—Ç–æ–¥ | –õ–æ–≥–∏–∫–∞ –∫–µ—à–∞ | TTL |
|-------|-------------|-----|
| `searchCharacters` | –ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí –ë–î ‚Üí –ö–µ—à | 300 —Å–µ–∫ (5 –º–∏–Ω) |
| `getCharacter` | –ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí –ë–î ‚Üí –ö–µ—à | 3600 —Å–µ–∫ (1 —á–∞—Å) |
| `searchPhrases` | –ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí –ë–î ‚Üí –ö–µ—à | 300 —Å–µ–∫ (5 –º–∏–Ω) |
| `analyzeText` | –ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí –ë–î ‚Üí –ö–µ—à | 1800 —Å–µ–∫ (30 –º–∏–Ω) |
| `getWordOfTheDay` | –ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí –ë–î ‚Üí –ö–µ—à | 86400 —Å–µ–∫ (24 —á–∞—Å–∞) |

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**:
- ‚úÖ `Cache hit for ...` –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ –≤ –∫–µ—à
- ‚úÖ `Cache miss for ...` –ø—Ä–∏ –ø—Ä–æ–º–∞—Ö–µ

#### 3.3 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**Docker Compose** (`docker-compose.yml`):
```yaml
dictionary-service:
  environment:
    REDIS_HOST: redis
    REDIS_PORT: 6379
  depends_on:
    redis:
      condition: service_healthy
```

**Package.json** (`services/dictionary/package.json`):
```json
{
  "dependencies": {
    "@nestjs/config": "^3.1.1",
    "ioredis": "^5.3.2"
  }
}
```

**–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**: ‚úÖ `Redis connected in Dictionary Service`

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**:
1. `PERFORMANCE_OPTIMIZATION_COMPLETE.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
2. `QUICK_START_OPTIMIZATION.md` - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
3. `OPTIMIZATION_SUMMARY.md` - —Å–≤–æ–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç
4. `IMPLEMENTATION_REPORT.md` - —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç
5. `infrastructure/scripts/apply-performance-migrations.sh` - —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**:
- –ü–æ–∏—Å–∫: 100-500ms
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞: 50-100ms
- –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞: 200-1000ms
- –°–ª–æ–≤–æ –¥–Ω—è: 50-100ms (–∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å)

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**:
- –ü–æ–∏—Å–∫ (–ø–µ—Ä–≤—ã–π —Ä–∞–∑): 50-200ms ‚ö° (2-3x –±—ã—Å—Ç—Ä–µ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –∏–Ω–¥–µ–∫—Å–∞–º)
- –ü–æ–∏—Å–∫ (–∏–∑ –∫–µ—à–∞): 1-5ms ‚ö°‚ö° (100x –±—ã—Å—Ç—Ä–µ–µ)
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞ (–∫–µ—à): 1-2ms ‚ö°‚ö° (50-100x –±—ã—Å—Ç—Ä–µ–µ)
- –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ (–∫–µ—à): 1-5ms ‚ö°‚ö° (40-200x –±—ã—Å—Ç—Ä–µ–µ)
- –°–ª–æ–≤–æ –¥–Ω—è (–∫–µ—à): 1-2ms ‚ö°‚ö° (25-50x –±—ã—Å—Ç—Ä–µ–µ)

### –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î

- **–û–±—â–µ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ**: 70-90% –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã**: –¥–æ 95% —Å–Ω–∏–∂–µ–Ω–∏–µ
- **–°–ª–æ–≤–æ –¥–Ω—è**: 99% —Å–Ω–∏–∂–µ–Ω–∏–µ (1 –∑–∞–ø—Ä–æ—Å –≤ –¥–µ–Ω—å –≤–º–µ—Å—Ç–æ —Ç—ã—Å—è—á)

### –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—ã–¥–µ—Ä–∂–∏—Ç 10x –±–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ë–î –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ latency –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤

```bash
docker exec -i guide-postgres psql -U postgres -d chinese_guide -c "\di"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Redis

```bash
docker-compose logs dictionary-service | grep Redis
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ‚úÖ Redis connected in Dictionary Service
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å (cache miss)
curl -X POST http://localhost:4001/graphql \
  -H "Content-Type: application/json" \
  -d '{"query":"query { searchCharacters(query: \"‰Ω†Â•Ω\", limit: 5) { id simplified } }"}'

# –õ–æ–≥–∏: Cache miss for search: ‰Ω†Â•Ω

# –í—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å (cache hit)
curl -X POST http://localhost:4001/graphql \
  -H "Content-Type: application/json" \
  -d '{"query":"query { searchCharacters(query: \"‰Ω†Â•Ω\", limit: 5) { id simplified } }"}'

# –õ–æ–≥–∏: Cache hit for search: ‰Ω†Â•Ω
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–≤–∞ –¥–Ω—è

```bash
curl -X POST http://localhost:4001/graphql \
  -H "Content-Type: application/json" \
  -d '{"query":"query { wordOfTheDay { id simplified pinyin definitions { translation } } }"}'
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ù–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º —Å–µ—Ä–≤–µ—Ä–µ

```bash
# 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
chmod +x infrastructure/scripts/apply-performance-migrations.sh
./infrastructure/scripts/apply-performance-migrations.sh

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd services/dictionary && npm install && cd ../..

# 3. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up --build -d dictionary-service user-service
```

### –ù–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å
git clone <repo>
cd guide-for-china

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up -d

# Prisma –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –≤—Å–µ –∏–Ω–¥–µ–∫—Å—ã –∏–∑ schema.prisma
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **HSK —É—Ä–æ–≤–Ω–∏**: –î–∞–Ω–Ω—ã–µ BKRS –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± HSK —É—Ä–æ–≤–Ω—è—Ö. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ - –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç.

2. **–†–∞–∑–º–µ—Ä –ë–î**: –ò–Ω–¥–µ–∫—Å—ã —É–≤–µ–ª–∏—á–∞—Ç —Ä–∞–∑–º–µ—Ä –ë–î –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 10-20%.

3. **Redis –ø–∞–º—è—Ç—å**: –ö–µ—à –±—É–¥–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å 100-500MB RAM –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.

4. **TTL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**: –ó–Ω–∞—á–µ–Ω–∏—è TTL –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `redis.service.ts` –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω—É–∂–¥—ã.

5. **Prisma schema**: –ò–Ω–¥–µ–∫—Å—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ schema –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–π. –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –±–∞–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã SQL –º–∏–≥—Ä–∞—Ü–∏–∏.

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ:

- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –ë–î —Å–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã (21 –Ω–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å)
- ‚úÖ Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ (5 —Ç–∏–ø–æ–≤ –∫–µ—à–∞)
- ‚úÖ –°–ª–æ–≤–æ –¥–Ω—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ production —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é! üöÄ

