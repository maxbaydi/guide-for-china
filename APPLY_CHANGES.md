# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ –≤–Ω–µ—Å–µ–Ω—ã –≤ –∫–æ–¥. –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î (‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

```bash
cd infrastructure
docker exec guide-postgres psql -U postgres -d chinese_guide -f postgres/migrations/006_optimize_examples_query.sql
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**: –°–æ–∑–¥–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–º–µ—Ä–æ–≤.

### 2. –û—á–∏—Å—Ç–∏—Ç—å Redis –∫–µ—à (‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

```bash
cd infrastructure/scripts
./clear-redis-cache.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**: –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏.

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã (‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

```bash
docker-compose restart dictionary-service api-gateway user-service
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**: –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞.

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs dictionary-service --tail=50

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã
docker exec guide-postgres psql -U postgres -d chinese_guide -c "\d examples"
```

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [x] –ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [x] –°–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞ —Å–æ–∑–¥–∞–Ω
- [ ] **‚Üí –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é 006**
- [ ] **‚Üí –û—á–∏—Å—Ç–∏—Ç—å Redis –∫–µ—à**
- [ ] **‚Üí –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã**
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞: **100-300 ms** (–±—ã–ª–æ 2-5 —Å–µ–∫—É–Ω–¥)
- –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏: **10-50 MB** (–±—ã–ª–æ 500+ MB)

### –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- –ù–µ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∏–µ—Ä–æ–≥–ª–∏—Ñ–æ–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## üîç –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### Backend
- ‚úÖ `dictionary.service.ts` - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ 20 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ `dictionary.controller.ts` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ 404
- ‚úÖ –ù–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è `006_optimize_examples_query.sql`
- ‚úÖ –°–∫—Ä–∏–ø—Ç `clear-redis-cache.sh`

### Frontend (Mobile)
- ‚úÖ `search.tsx` - —É–ª—É—á—à–µ–Ω–Ω–∞—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å "—Å–ª–æ–≤–∞ –¥–Ω—è"

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ `DATABASE_SCHEMA.md` - –ø–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î
- ‚úÖ `prisma/schema.prisma` - –µ–¥–∏–Ω–∞—è Prisma —Å—Ö–µ–º–∞
- ‚úÖ `OPTIMIZATION_SUMMARY.md` - —Å–≤–æ–¥–∫–∞ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ `DICTIONARY_OPTIMIZATION_COMPLETE.md` - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ú–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–∞** - —Å–æ–∑–¥–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å, –Ω–µ –º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
2. **–û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞** - –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–º–µ–¥–ª–∏—Ç –ø–µ—Ä–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–ø–æ—Ç–æ–º –±—ã—Å—Ç—Ä–æ)
3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫** - –∑–∞–Ω–∏–º–∞–µ—Ç ~5 —Å–µ–∫—É–Ω–¥
4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–≥—Ä–æ–º–Ω–∞—è** - 15+ –º–ª–Ω –ø—Ä–∏–º–µ—Ä–æ–≤, 3.4 –º–ª–Ω –∏–µ—Ä–æ–≥–ª–∏—Ñ–æ–≤

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs -f dictionary-service`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–¥–µ–∫—Å—ã: `docker exec guide-postgres psql -U postgres -d chinese_guide -c "\di"`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Redis: `redis-cli KEYS *` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏)

## üîÑ –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
docker exec guide-postgres psql -U postgres -d chinese_guide -c "DROP INDEX IF EXISTS idx_examples_character_id_created;"

# –û—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–¥ —á–µ—Ä–µ–∑ git
git checkout HEAD~1 services/dictionary/src/services/dictionary.service.ts
git checkout HEAD~1 services/api-gateway/src/dictionary/dictionary.controller.ts
git checkout HEAD~1 mobile/app/(tabs)/search.tsx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose restart dictionary-service api-gateway
```

---

**–î–∞—Ç–∞**: 2025-10-15  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é  
**–í—Ä–µ–º—è –Ω–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: ~2 –º–∏–Ω—É—Ç—ã

